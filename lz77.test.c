#include "lz77.h"
#include "cc65-test.h"
#include <stdio.h>

uint8_t compressed[] = {
	0x00, 0x00, 0x43, 0xEF, 0x00, 0x5F, 0xCB, 0x09, 0x44, 0x00, 0x0A, 0x04, 0xB9, 0x00, 0x00, 0xDA,
	0x00, 0x5A, 0xEF, 0x0A, 0x0B, 0xCB, 0x02, 0x87, 0x00, 0x00, 0x53, 0xEF, 0x0A, 0x15, 0xA6, 0x00,
	0x00, 0xA7, 0x0A, 0x23, 0xA6, 0x09, 0x42, 0xB6, 0x00, 0x00, 0xB7, 0x0A, 0x23, 0xB6, 0x09, 0x51,
	0x00, 0x1E, 0x18, 0x00, 0x00, 0x4E, 0xA6, 0x18, 0x82, 0xEF, 0x0A, 0x24, 0xB6, 0x18, 0x82, 0xEF,
	0x0A, 0x1B, 0x66, 0x00, 0x00, 0x67, 0x1E, 0x16, 0xEF, 0x00, 0x41, 0xBB, 0x5B, 0xD4, 0xBB, 0x05,
	0x46, 0xCB, 0x5A, 0x0B, 0xDB, 0x01, 0xC2, 0xD9, 0x58, 0xD1, 0xDB, 0x05, 0x44, 0xEF, 0x5A, 0x3D,
	0x00, 0x0A, 0x3F, 0x00, 0x32, 0x3F, 0xDA, 0x32, 0x3F, 0x00, 0x0A, 0x3F, 0x00, 0x32, 0x3F, 0xDA,
	0x32, 0x3F, 0x00, 0x0A, 0x3F, 0x00, 0x32, 0x17, 0xEF, 0xF0, 0x1F};

char original[] = {
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xB9, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xA6, 0xA7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xA6, 0xA7, 0x00, 0xB6, 0xB7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xB6, 0xB7, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xA6, 0xA7, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xB6, 0xB7, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x66, 0x67, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xEF, 0xEF, 0xBB, 0x00, 0x00, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xBB, 0x00, 0x00, 0xEF, 0xEF, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xB9, 0xDA, 0xDB, 0x00, 0x00, 0xD9, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDB, 0x00, 0x00, 0xD9, 0xDA, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xEF, 0xEF, 0xBB, 0x00, 0x00, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xBB, 0x00, 0x00, 0xEF, 0xEF, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xB9, 0xDA, 0xDB, 0x00, 0x00, 0xD9, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDB, 0x00, 0x00, 0xD9, 0xDA, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xEF, 0xEF, 0xBB, 0x00, 0x00, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xBB, 0x00, 0x00, 0xEF, 0xEF, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xB9, 0xDA, 0xDB, 0x00, 0x00, 0xD9, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDA, 0xDB, 0x00, 0x00, 0xD9, 0xDA, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xEF, 0xCB, 0x00, 0x00, 0x00};

void lz77Test()
{
	beginTest("Decompress.");
	{
		uint8_t decompressed[1000];

		lz77Decompress(compressed, sizeof(compressed), decompressed, sizeof(decompressed));

		{
			uint16_t i;
			for (i = 0; i < sizeof(original) - 1; ++i)
			{
				assertByte("Content", decompressed[i], original[i]);
			}
		}
	}
	endTest();
}
